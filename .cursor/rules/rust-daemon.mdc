---
description: Rules for Rust daemon development
globs: ["daemon/**/*.rs", "Cargo.toml", "Cargo.lock"]
---

# Rust Binary Rules

## Architecture Boundary (ARCH-001)

Single Rust binary. No persistent daemon. No LLM calls.

Responsibilities:
- MCP server (rmcp crate)
- CLI commands (clap crate)
- SQLite storage (rusqlite)
- Git hooks (doc debt detection)

NEVER:
- Makes LLM API calls
- Runs as a persistent daemon
- Watches files or logs

## Key Crates

| Purpose | Crate |
|---------|-------|
| Async runtime | tokio |
| MCP server | rmcp |
| CLI parsing | clap |
| SQLite | rusqlite |
| Serialization | serde, serde_json, serde_yaml |
| Glob matching | glob |
| Regex | regex |
| Error handling | thiserror |

## Error Handling

Use thiserror for error types. Graceful failures in hooks (exit 0, never block git).

## Platform Support

Must compile on macOS, Linux, Windows. No OS-specific hacks.
